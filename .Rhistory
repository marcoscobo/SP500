lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
simulate.apply <- function(i, df, years.to.sim, save, plot.n, plot.l){
last.init <- length(df$Date) - 252 * years.to.sim
init.day <- sample(1:last.init, size=1) + 1
last.day <- init.day + 252 * years.to.sim - 1
sim.period <- init.day:last.day
sim.sample <- sample(sim.period, replace=T)
sim.diff <- df$Diff_close_div[sim.sample]
anual.rent <- prod(sim.diff) ** (1 / years.to.sim)
if (save == T | plot.n == T | plot.l == T){
simuls[,i] <- cumprod(sim.diff)
}
return(anual.rent)
}
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
set.seed(0)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
number.of.sim <- 100000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
number.of.sim <- 1000000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l = T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l = T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l = T)
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l = T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l = T)
anual.rents <- simulate(df, years.to.sim, number.of.sim, save = T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
anual.rents <- simulate(df, years.to.sim, number.of.sim, paral=T)
source("simulations.R")
anual.rents <- simulate(df, years.to.sim, number.of.sim, paral=T)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 100000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 100000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 100000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
calc.prob <- function(x, simuls){
return(length(simuls[simuls < x]) / length(simuls))
}
1 - calc.prob(1.05, anual.rents)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
View(simulate)
number.of.sim <- 10000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
probs <- c()
for (year in 1:10){
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1.05, anual.rents))
}
probs
x11()
plot(probs, type='l')
probs <- c()
for (year in 1:50){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1.05, anual.rents))
}
x11()
plot(probs, type='l')
number.of.sim <- 1000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1.05, anual.rents))
}
x11()
plot(probs, type='l')
number.of.sim <- 10000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1.05, anual.rents))
}
x11()
plot(probs, type='l')
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1.05 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 1000000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
x11()
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1.05 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 10000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1.05, anual.rents))
}
x11()
plot(probs, type='l')
abline(h=0.05, lwd=2, col='red')
abline(h=0.01, lwd=2, col='green')
prob1
prob1*100
number.of.sim <- 10000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 10000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
x11()
plot(probs, type='l')
abline(h=0.01, lwd=2, col='green')
number.of.sim <- 10
probs <- c()
for (year in 1:60){
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
plot(probs, type='l')
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 500
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
years.to.sim <- 25
number.of.sim <- 500
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=F)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 1000000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 10000
probs <- c()
for (year in 1:60){
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
plot(probs, type='l')
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
number.of.sim <- 100
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
png(filename = 'hist.png', width=1920, height=1080)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
dev.off()
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 20
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
png(filename = 'hist.png', width=1920, height=1080)
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
dev.off()
x11(); par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL)
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T)
lines(density(anual.rents), col='red', main='Density function')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative distribution function')
png(filename = 'hist.png', width=1920, height=1080) #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative distribution function')
dev.off() #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative distribution function')
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
png(filename = 'dist1.png', width=1920, height=1080) #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
dev.off() #Delete---------------------------------
parallel
?parallel
parSapply
?parSapply
length
?length
number.of.sim <- 1000000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
png(filename = 'dist2.png', width=1920, height=1080) #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
dev.off() #Delete---------------------------------
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 10000
probs1 <- probs2 <- c()
for (year in 1:60){
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs1 <- c(probs1, calc.prob(1, anual.rents))
probs2 <- c(probs2, 1 - calc.prob(1.05, anual.rents))
}
plot(probs1, type='l', main='Probability of anual yield <= 0%')
plot(probs2, type='l', main='Probability of anual yield > 5%')
par(mfrow = c(1, 1))
plot(probs1, type='l', main='Probability of anual yield <= 0%')
abline(h=0, lty=3, col='red')
plot(probs2, type='l', main='Probability of anual yield > 5%')
abline(h=0, lty=3, col='red')
plot(probs1, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
plot(probs2, type='l', main='Probability of anual yield > 5%')
abline(h=0.9, lty=3, col='red')
plot(probs1, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
number.of.sim <- 100000
probs <- c()
for (year in 1:60){
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
png(filename = 'dist_temp.png', width=1920, height=1080) #Delete---------------------------------
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
dev.off() #Delete---------------------------------
number.of.sim <- 100000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
png(filename = 'dist_temp.png', width=1920, height=1080) #Delete---------------------------------
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
dev.off() #Delete---------------------------------
probs[22]
probs[23]
## Part I
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 20
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot=T)
png(filename = 'hist.png', width=1920, height=1080) #Delete---------------------------------
hist(anual.rents, breaks=seq(min(anual.rents) - 0.01, max(anual.rents) + 0.01, by=0.01))
dev.off() #Delete---------------------------------
png(filename = 'dist1.png', width=1920, height=1080) #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
dev.off() #Delete---------------------------------
number.of.sim <- 1000000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
png(filename = 'dist2.png', width=1920, height=1080) #Delete---------------------------------
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
dev.off() #Delete---------------------------------
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 100000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T)
probs <- c(probs, calc.prob(1, anual.rents))
}
png(filename = 'dist_temp.png', width=1920, height=1080) #Delete---------------------------------
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
dev.off() #Delete---------------------------------
probs[22]
probs[23]
source("simulations.R")
df <- read.csv("SP500.csv")
years.to.sim <- 20
number.of.sim <- 1000000
anual.rents <- simulate.apply(df, years.to.sim, number.of.sim, paral=T)
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
anual.rents <- anual.rents - 0.001
par(mfrow = c(2, 1))
hist(anual.rents, breaks=seq(min(anual.rents) - 0.005, max(anual.rents) + 0.005, by=0.005), prob=T, main='Density Function')
lines(density(anual.rents), col='red')
plot(ecdf(anual.rents), col='red', col.01line=NULL, main='Cumulative Distribution Function')
calc.prob <- function(x, simuls){
return(length(simuls[simuls <= x]) / length(simuls))
}
prob1 <- calc.prob(1, anual.rents)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, prob1)
prob2 <- 1 - calc.prob(1.05, anual.rents)
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, prob2)
number.of.sim <- 10000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T) - 0.001
probs <- c(probs, calc.prob(1, anual.rents))
}
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
probs[22]
probs[23]
probs[24]
par(mfrow = c(2, 1))
par(mfrow = c(1, 1))
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
number.of.sim <- 100000
probs <- c()
for (year in 1:60){
print(year)
anual.rents <- simulate.apply(df, year, number.of.sim, paral=T) - 0.001
probs <- c(probs, calc.prob(1, anual.rents))
}
plot(probs, type='l', main='Probability of anual yield <= 0%')
abline(h=0.01, lty=3, col='red')
