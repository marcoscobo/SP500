library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, save=T)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2]) * 100
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2]) * 100
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2])) * 100
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2])) * 100
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 2000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 100
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 10
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
years.to.sim <- 25
years.to.sim <- 35
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
years.to.sim <- 50
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
par(mfrow = c(2, 2))
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
qqcomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
ppcomp(list(fn, fl), legendtext = plot.legend)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
df <- read.csv("amounts.csv")
amounts <- df$Amounts
hist(amounts)
breaks <- seq(0,5e+6,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,6e+6,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=10)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=100)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=1000)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=100)
hist(amounts, breaks = breaks)
breaks <- seq(0,7e+6, length.out=100)
hist(amounts, breaks = breaks)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T)
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2]) * 100
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
years.to.sim <- 50
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T)
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
View(df)
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
hist(anual.rents)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
par(mfrow = c(2, 2))
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
qqcomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
ppcomp(list(fn, fl), legendtext = plot.legend)
x11()
par(mfrow = c(1, 2))
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
par(mfrow = c(1, 2))
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
View(fl)
number.of.sim <- 100
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
years.to.sim <- 25
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
hist(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
years.to.sim <- 35
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
par(mfrow = c(1, 2))
cdfcomp(list(fn, fl), legendtext = plot.legend)
denscomp(list(fn, fl), legendtext = plot.legend)
shapiro.test(anual.rents)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
years.to.sim <- 50
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
shapiro.test(anual.rents)
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 80
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
length(df$Close) /
length(df$Close)
length(df$Close)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 80
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=T, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
years.to.sim <- 35
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
years.to.sim <- 25
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
lprob3 <- (1 - plogis(1.04, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
lprob3 <- (1 - plogis(1.03, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
lprob3 <- (1 - plogis(1.02, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
lprob3 <- (1 - plogis(1.01, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
lprob3 <- (1 - plogis(1, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
years.to.sim <- 50
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
years.to.sim <- 60
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
years.to.sim <- 70
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
years.to.sim <- 80
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
df <- read.csv("SP500.csv")
View(df)
df$Date = str_replace(df$Date, "-", "")
df$Date = gsub("-", "", df$Date)
View(df)
df$Date[length(df$Date)]
df$Date[length(df$Date)] - df$Date[1]
df$Date[length(df$Date)] - df$Date[1]
df$Date[1]
df$Date = as.integer(gsub("-", "", df$Date))
df$Date[length(df$Date)] - df$Date[1]
df <- read.csv("SP500.csv")
df$Date <- as.Date(df$Date)
View(df)
df$Date[length(df$Date)] - df$Date[1]
a <- df$Date[length(df$Date)] - df$Date[1]
a
difftime(f$Date[length(df$Date)], df$Date[1], 'days')
difftime(f$Date[length(df$Date)], df$Date[1], units = 'days')
difftime(df$Date[length(df$Date)], df$Date[1], units = 'days')
difftime(df$Date[length(df$Date)], df$Date[1], units = 'years')
difftime(df$Date[length(df$Date)], df$Date[1], units = 'wekks')
difftime(df$Date[length(df$Date)], df$Date[1], units = 'weeks')
difftime(df$Date[length(df$Date)], df$Date[1], units = 'weeks') / 52
l <- as.float(difftime(df$Date[length(df$Date)], df$Date[1], units = 'weeks') / 52)
l <- as.numeric(difftime(df$Date[length(df$Date)], df$Date[1], units = 'weeks') / 52)
l
l <- as.numeric(difftime(df$Date[length(df$Date)], df$Date[1], units = 'days'))
l
length(df$Close) / 252
source("simulations.R")
rent <- hist.rent(df, verbose=T)
View(df)
rent <- hist.rent(df, verbose=T)
View(df)
source("simulations.R")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
length(df$Close) / 252
l <- as.numeric(difftime(df$Date[length(df$Date)], df$Date[1], units = 'days'))
l
length(df$Close) / 251
length(df$Close) / 250
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
length(df$Close) / 360
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
source("simulations.R")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
View(df)
View(df)
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
source("~/Escritorio/AlgoTrading/SP500/simulations.R")
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
View(df)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
View(df)
View(df)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 25
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim, plot.l=F, cero.line=T)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
qqcomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
ppcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2])
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2]))
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
cdfcomp(list(fn, fl), legendtext = plot.legend)
