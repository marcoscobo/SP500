library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
source("simulations.R")
df <- read.csv("SP500.csv")
rent <- hist.rent(df, verbose=T)
sprintf('Rentabilidad anual media = %4f', (rent - 1) * 100)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim, save=T)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
## CALCULO DE PROBABILIDADES
sprintf('Rentabilidad anual media: %4f', mean(anual.rents))
# normal
nprob <- pnorm(1, mean=fn$estimate[1], sd=fn$estimate[2]) * 100
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, nprob)
nprob2 <- (pnorm(1.14, mean=fn$estimate[1], sd=fn$estimate[2]) - pnorm(1.06, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, nprob2)
nprob3 <- (1 - pnorm(1.05, mean=fn$estimate[1], sd=fn$estimate[2])) * 100
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, nprob3)
# logistic
lprob <- plogis(1, location=fl$estimate[1], scale=fl$estimate[2]) * 100
sprintf('Probabilidad de rent <= 1 a %i años: %4f', years.to.sim, lprob)
lprob2 <- (plogis(1.14, location=fl$estimate[1], scale=fl$estimate[2]) - plogis(1.06, location=fl$estimate[1], scale=fl$estimate[2])) * 100
sprintf('Probabilidad de rent en (1.06,1.14) a %i años: %4f', years.to.sim, lprob2)
lprob3 <- (1 - plogis(1.05, location=fl$estimate[1], scale=fl$estimate[2])) * 100
sprintf('Probabilidad de rent > 1.05 a %i años: %4f', years.to.sim, lprob3)
number.of.sim <- 10000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 5000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 2000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 100
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
number.of.sim <- 10
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
plot.legend <- c("norm", "logis")
cdfcomp(list(fn, fl), legendtext = plot.legend)
years.to.sim <- 25
years.to.sim <- 35
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
years.to.sim <- 50
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
years.to.sim <- 25
number.of.sim <- 1000
anual.rents <- simulate(df, years.to.sim, number.of.sim)
shapiro.test(anual.rents)
fn <- fitdist(anual.rents, "norm")
fl <- fitdist(anual.rents, "logis")
x11()
par(mfrow = c(2, 2))
plot.legend <- c("norm", "logis")
denscomp(list(fn, fl), legendtext = plot.legend)
qqcomp(list(fn, fl), legendtext = plot.legend)
cdfcomp(list(fn, fl), legendtext = plot.legend)
ppcomp(list(fn, fl), legendtext = plot.legend)
library(fitdistrplus) # "norm", "lnorm", "pois", "exp", "gamma", "nbinom", "geom", "beta", "unif", "logis"
df <- read.csv("amounts.csv")
amounts <- df$Amounts
hist(amounts)
breaks <- seq(0,5e+6,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,6e+6,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7,by=1e+4)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=10)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=100)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=1000)
hist(amounts, breaks = breaks)
breaks <- seq(0,1e+7, length.out=100)
hist(amounts, breaks = breaks)
breaks <- seq(0,7e+6, length.out=100)
hist(amounts, breaks = breaks)
